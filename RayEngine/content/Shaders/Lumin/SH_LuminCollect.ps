#include "Shaders/Uniforms/SH_FrameUniforms.si"
#include "Shaders/Uniforms/SH_TexUniforms.si"
#include "Shaders/Utility/SH_Utility.si"
#include "Shaders/Utility/SH_CubeSampling.si"

#include "Shaders/PBR/SH_SphericalHarmonics.si"

in vec2 TexCoord;
in vec2 RectCoord;

layout(location = 0) out vec4 OutSH;

int GetProbeIndex(probePos);

// This shader runs for every SH pixel
// TODO: Set viewport so that only relevant pixels are covered
void main()
{
    vec2 texel = vec2(1.0f) / Resolution;

    vec2 pixel = TexCoord * Resolution;
    int pixelIndex = int(pixel.y * Resolution.x) + int(pixel.x);
    int positionIndex = pixelIndex / 9; // 9 bands
    int shBand = pixelIndex % 9;
    
    // Total number of entries = (4096 / 9) = 455
    // 8*8*8
    
    
    // probe position = camera position
    vec3 probePos = CameraPosition;
    vec3 camDir = Normalize(worldPos.xyz - CameraPosition);
    
    
    Accumu
    
    // Go from cube UV to direction?
    
}
